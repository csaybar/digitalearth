---
title: "Surface runoff analysis in an alpine catchment"
author: "Cesar Aybar"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: 
  html_document:
    toc: true
    toc_float: true
    number_sections: true
    css: "style.css"
---

```{r setup, include=FALSE}
source("functions.R")
```

# **Research Area** 

Our area of interest is located in the southern part of the state of Salzburg close to Schmitten and Viehhofen cities. It is a small catchment of 120 km2 draining to the Saalach river. The elevation data for this assignment was obtained from the product [ALOS World 3D (AW3D30)](http://www.eorc.jaxa.jp/ALOS/en/aw3d30/aw3d30v11_format_e.pdf). In the map below, we display the stream network and basin delineation according to the official information of the Land Salzburg.

```{r echo=FALSE}
mapview::mapviewOptions(fgb = FALSE)
suppressMessages(suppressWarnings(map_01()))
```

**Mouse over the pixels to obtain elevation values.**

# **Comparing SAGA GIS results vs Official information** 

After a visual inspection, it can be concluded that there is no significance differences between the catchment generate by SAGA GIS and the official one created by the Land Salzburg. However, due that the basin generated by SAGA use elevation values of 30 meters (AW3D30) the course resolution of the results is notorious.


```{r message=FALSE, echo=FALSE}
suppressMessages(suppressWarnings(map_02()))
```

The map in the **left**(**right**) side was generated using **SAGA** (information from **Land Salzburg**).  

# **Concentration time map** 

Considering a maximum time of concentration (**60 minutes**), we calculate the concentration time for all the pixels of the catchment taking into account the longest watercourse length and the average slope of the watercourse. See the next [**C++ code**](https://sourceforge.net/p/saga-gis/code/ci/master/tree/saga-gis/src/tools/terrain_analysis/ta_hydrology/IsochronesVar.cpp#l475) to get more information about the empirical equations used here.

```{r message=FALSE, echo=FALSE}
suppressMessages(suppressWarnings(map_03()))
```

**Mouse over the pixels to obtain the concentration time value.**

# **Critical Zones**

The histogram below shows that most critical areas are located at a concentration-time from 30 to 50 minutes to the next pour point. In a hydrological sense, these areas are the principal contributor to the streamflow in the pour point. Therefore, it is important
increase the water storage, increasing forest areas and/or avoiding crop areas, to prevent flash floods.

```{r message=FALSE, echo = FALSE}
suppressMessages(suppressWarnings(map_04()))
```

# **Importance of DEM preprocesing**

To create the streamflow of the basin, a critical first step is to remove unnatural sinks in the DEM in order to generate a continuous surface of accumulation. The figure below shows the difference between use or not a  fill sink algorithm (for this example we use 
[L Wang 2006](https://www.tandfonline.com/doi/full/10.1080/13658810500433453)
algorithm) in a DEM with 30 meters of spatial resolution. 

```{r message=FALSE, echo=FALSE}
mapview::mapviewOptions(fgb = FALSE)
suppressMessages(suppressWarnings(map_05()))
```

# **Conclusions**

After finishing this assignment, we can conclude some points:

   - If the proper analysis is carried out, only using the DEM could give to the analyst a general understanding of the hydrology of a basin.
   - The fill sink is crucial in determining the flow accumulation.
   - The concentration time (flow length) gives us information on the areas that most influence the streamflow. However, this information must be contrasted with the land use and the spatial distribution of the precipitation in order to obtain results more according with reality.