---
title: "Getting terrain information in Salzburg Catchments"
output:
  flexdashboard::flex_dashboard:
    storyboard: yes
    social: menu
    source: embed
    css: style.css
---

```{r setup, include=FALSE}
library(googleCloudStorageR)
library(reticulate)
library(leaflet)
library(leafem)
library(raster)
library(stars)
library(sf)
source("functions.R")
```

### **Area of Interest (AOI)** {data-commentary-width=400}

```{r}
mapview::mapviewOptions(fgb = FALSE)
question_01_01()
```

------------------------------------------------------------------------

<div class="floro">

Our area of interest is located in the southern part of the state of Salzburg close to Schmitten city. The Digital Elevation Models (DEM) values were obtained from the product [ALOS World 3D (AW3D30)](http://www.eorc.jaxa.jp/ALOS/en/aw3d30/aw3d30v11_format_e.pdf). In the map at the right, we display the slope.

**Mouse over the pixels to obtain the real value.**

</div>


### **Slope distribution** {data-commentary-width=400}

```{r}
question_01_02()
```

------------------------------------------------------------------------

<div class="floro">
Our area of interest is located in southern part of the state of Salzburg close to the Schmitten city. The Digital Elevation Models (DEM) values where obtained from the product [ALOS World 3D (AW3D30)](http://www.eorc.jaxa.jp/ALOS/en/aw3d30/aw3d30v11_format_e.pdf). In the map at the right, 
we display the slope.


Considering the slope classification of [V. Zhuchkova and E. Rakovskaya, 2017](https://www.researchgate.net/figure/Classification-of-slope-by-V-Zhuchkova-and-E-Rakovskaya_tbl1_322622715). On average, this catchment could be classified as **very steep**, presenting the lowest values near to the main river and the highest ones close to the drainage divide.

</div>

### **How to estimate the curvature? - I** {data-commentary-width=400}

```{r}
question_02_00()
```

------------------------------------------------------------------------

<div class="floro">
In simple words, we can define the **curvature** as the second derivative of a surface, or the slope of the slope. In surface water hydrology, the concept of curvature plays an important role to understand where the water drains off. 

A negative value indicates that the surface is upwardly convex at that cell, and flow will be decelerated. A positive profile indicates that the surface is upwardly concave at that cell, and the flow will be accelerated. A value of zero indicates that the surface is linear (See [curvature function ArcGIS](https://desktop.arcgis.com/en/arcmap/10.3/manage-data/raster-and-images/curvature-function.htm)).
</div>



### **How to estimate the curvature? - II** {data-commentary-width=400}

```{r}
question_02_01()
```

------------------------------------------------------------------------

<div class="floro">
**However**, the curvature is not the only model that explains deformations. Other models like the TPI (Topographic Position Index) given also information about the convex or concave of the terrain. In a TPI model the negative values, represent valleys, canyon, and bottoms, and the positive values
ridges and hilltops. To estimate the TPI we need to apply a convolution operator and estimate the difference between the value of a cell and the mean value of its 8 surrounding cells. 
</div>



### **Slope according to the altitute - I** {data-commentary-width=400}

```{r}
question_03_01()
```

------------------------------------------------------------------------

<div class="floro">
For analyzing the local behavior of the slope. The entire catchment was divided into smaller units according to 200m stripes of the elevation.
</div>


### **Slope according to the altitute - II** {data-commentary-width=400}

```{r}
question_03_02()
```

------------------------------------------------------------------------

<div class="floro">
For analyzing the local behavior of the slope. The entire catchment was divided into smaller units according to 200m stripes of the elevation.

The results show that the values of the slope are linearly correlated with changes in the elevation.
</div>


### **Cellsize importance - I** {data-commentary-width=400}

```{r}
question_03_03()
```

------------------------------------------------------------------------

<div class="floro">
This example shows how different is the spatial distribution of slope values if is used a digital elevation model of 120 m instead of  30 m of spatial resolution. 
</div>


### **Cellsize importance - II** {data-commentary-width=400}

```{r}
question_03_04()
```

------------------------------------------------------------------------

<div class="floro">
This example shows how different is the spatial distribution of slope values if is used a digital elevation model of 120 m instead of  30 m of spatial resolution. 

As it can notice, a larger cell size generates values closer to the mean.
</div>


### **Conclusion** {data-commentary-width=400}

Terrain analysis is the basis of several earth observation projects. **The digital terrain models (DTM)** derived from DEM, show us that in this specific catchment:

  - The slope change according to the altitude.

  - There is more common to find negative values of curvature in the valleys (low altitude areas).

  - And finally, the cell size (from 30 to 120 meters) changes sightly the first and second moment of our slope statistical distribution.

